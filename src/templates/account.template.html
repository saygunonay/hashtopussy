{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}
<h2>[[lang.get('myaccount_myaccount')]] ([[htmlentities([[user.getUsername()]], ENT_QUOTES, "UTF-8")]])</h2>
{%TEMPLATE->struct/messages%}
<div class="panel panel-default">
	<table class="table table-bordered table-nonfluid">
		<tr>
			<th>[[lang.get('table_property_user_type')]]</th>
			<td>
				[[group.getGroupName()]]
			</td>
		</tr>
		<tr>
			<th>[[lang.get('table_property_registration_date')]]</th>
			<td>
				[[date([[config.getVal(DConfig::TIME_FORMAT)]], [[user.getRegisteredSince()]])]]
			</td>
		</tr>
		<tr>
			<th>[[lang.get('table_property_email_address')]]</th>
			<td>
				<form class='form-inline' action="account.php" method="post">
					<input type='hidden' name='action' value='[[$DAccountAction::SET_EMAIL]]'>
					<input type='email' name='email' class='form-control' value='[[user.getEmail()]]'>
					<input type="hidden" name="csrf" value="[[csrf]]">
					<input type="submit" class='btn btn-default' value="[[lang.get('button_update')]]">
				</form>
			</td>	
		</tr>
		<tr>
			<th>[[lang.get('table_property_session_length')]]</th>
			<td>
				<form class='form-inline' action="account.php" method="post">
					<input type='hidden' name='action' value='[[$DAccountAction::UPDATE_LIFETIME]]'>
					<input type='text' name='lifetime' class='form-control' value='[[user.getSessionLifetime()]]'> [[lang.get('seconds')]]
					<input type="hidden" name="csrf" value="[[csrf]]">
					<input type="submit" class='btn btn-default' value="[[lang.get('button_update')]]">
				</form>
			</td>	
		</tr>
		<tr>
			<th>[[lang.get('table_property_password')]]</th>
			<td>
				<form class='form-inline' action="account.php" method="post">
					<input type='hidden' name='action' value='[[$DAccountAction::CHANGE_PASSWORD]]'>
					<input type='password' name='oldpass' class='form-control' placeholder='[[lang.get('myaccount_old_password')]]'>
					<input type='password' name='newpass' class='form-control' placeholder='[[lang.get('myaccount_new_password')]]'>
					<input type='password' name='reppass' class='form-control' placeholder='[[lang.get('myaccount_repeat_password')]]'>
					<input type="hidden" name="csrf" value="[[csrf]]">
					<input type="submit" class='btn btn-default' value="[[lang.get('button_change_password')]]">
				</form>
			</td>
		</tr>
	</table>
</div>
<div class="panel panel-default">
	<table class="table table-bordered table-nonfluid">
		<tr>
			<td colspan="2">
				<div class="alert alert-warning">
					[[lang.get('myaccount_disclaimer_otp')]]
				</div>
			</td>
		</tr>
		{{IF ![[Util::isYubikeyEnabled()]]}}
			<tr>
				<th>[[lang.get('table_property_yubikey_otp')]]</th>
				<td>
					[[lang.get('myaccount_description_yubikey_otp')]]
				</td>
			</tr>
		{{ELSE}}
			<tr>
				<th>[[lang.get('table_property_enable_yubikey_otp')]]</th>
					<td>
						{{IF [[user.getYubikey()]] == 1}}
							<form class='form-inline' action="account.php" method="post">
								[[lang.get('myaccount_description_yubikey_enabled')]]
								<input type='hidden' name='action' value='[[$DAccountAction::YUBKEY_DISABLE]]'>
								<input type="hidden" name="csrf" value="[[csrf]]">
								<input type="submit" class='btn btn-warning' value="[[lang.get('button_disable')]]">
							</form>
						{{ELSE}}
							<form class='form-inline' action="account.php" method="post">
								[[lang.get('myaccount_description_yubikey_disabled')]]
								<input type='hidden' name='action' value='[[$DAccountAction::YUBKEY_ENABLE]]'>
								<input type="hidden" name="csrf" value="[[csrf]]">
								<input type="submit" class='btn btn-success' value="[[lang.get('button_enable')]]">
							</form>
						{{ENDIF}}
					</td>
			</tr>
			<tr>
				<th>[[lang.get('otp_key')]] 1:</th>
				<td>
					<form class='form-inline' action="account.php" method="post">
						<input type='hidden' name='action' value='[[$DAccountAction::SET_OTP1]]'>
						<input type='text' name='otp1' class='form-control' value='[[user.getOtp1()]]'>
						<input type="hidden" name="csrf" value="[[csrf]]">
						<input type="submit" class='btn btn-default' value="[[lang.get('button_update')]]">
					</form>
				</td>
			</tr>
			<tr>
				<th>[[lang.get('otp_key')]] 2:</th>
				<td>
					<form class='form-inline' action="account.php" method="post">
						<input type='hidden' name='action' value='[[$DAccountAction::SET_OTP2]]'>
						<input type='text' name='otp2' class='form-control' value='[[user.getOtp2()]]'>
						<input type="hidden" name="csrf" value="[[csrf]]">
						<input type="submit" class='btn btn-default' value="[[lang.get('button_update')]]">
					</form>
				</td>
			</tr>
			<tr>
				<th>[[lang.get('otp_key')]] 3:</th>
				<td>
					<form class='form-inline' action="account.php" method="post">
						<input type='hidden' name='action' value='[[$DAccountAction::SET_OTP3]]'>
						<input type='text' name='otp3' class='form-control' value='[[user.getOtp3()]]'>
						<input type="hidden" name="csrf" value="[[csrf]]">
						<input type="submit" class='btn btn-default' value="[[lang.get('button_update')]]">
					</form>
				</td>
			</tr>
			<tr>
				<th>[[lang.get('otp_key')]] 4:</th>
				<td>
					<form class='form-inline' action="account.php" method="post">
						<input type='hidden' name='action' value='[[$DAccountAction::SET_OTP4]]'>
						<input type='text' name='otp4' class='form-control' value='[[user.getOtp4()]]'>
						<input type="hidden" name="csrf" value="[[csrf]]">
						<input type="submit" class='btn btn-default' value="[[lang.get('button_update')]]">
					</form>
				</td>
			</tr>
		{{ENDIF}}
	</table>
</div>
{%TEMPLATE->struct/foot%}
