{%TEMPLATE->struct/head%}
{%TEMPLATE->struct/menu%}
<h2>[[lang.get('agents_new_add_new_agent')]]</h2>
{%TEMPLATE->struct/messages%}
<div class='alert alert-info'>
	[[lang.get('agents_new_description_general')]]
	<code>[[apiUrl]]</code>
</div>
<h3>[[lang.getUCF('Clients')]]</h3>
<div class="panel panel-default">
	<table class="table table-bordered table-nonfluid">
    <tr>
		<th>[[lang.get('table_property_id')]]</th>
		<th>[[lang.get('table_property_version')]]</th>
      	<th>[[lang.get('table_property_programming_language')]]</th>
      	<th>[[lang.get('table_property_operating_system')]]</th>
      	<th>[[lang.get('table_property_filename')]]</th>
      	<th>&nbsp;</th>
    </tr>
		{{FOREACH binary;[[agentBinaries]]}}
      <tr>
        <td>[[binary.getId()]]</td>
		<td>[[binary.getVersion()]]</td>
        <td>[[binary.getType()]]</td>
        <td>[[binary.getOperatingSystems()]]</td>
        <td>[[binary.getFilename()]]</td>
        <td>
          <form action="agents.php?new=true" method="POST">
            <input type="hidden" name="action" value="[[$DAgentAction::DOWNLOAD_AGENT]]">
            <input type="hidden" name="binary" value="[[binary.getId()]]">
						<input type="hidden" name="csrf" value="[[csrf]]">
            <input type="submit" class='btn btn-primary' value="[[lang.get('button_download')]]">
          </form><br>
					<code>[[agentUrl]][[binary.getId()]]</code>
        </td>
      </tr>
    {{ENDFOREACH}}
	</table>
</div>
{{IF [[sizeof([[vouchers]])]] > 0}}
  <h3>[[lang.get('agents_new_vouchers')]]</h3>
	<div class="panel panel-default">
		<table class="table table-bordered table-nonfluid">
			{{FOREACH voucher;[[vouchers]]}}
				<tr>
					<td><code>[[voucher.getVoucher()]]</code></td>
          			<td>[[date([[config.getVal(DConfig::TIME_FORMAT)]], [[voucher.getTime()]])]]</td>
          			<td>
          				<form action="agents.php?new=true" method="POST" onSubmit="if (!confirm('[[lang.get('post_confirm_msg_delete_voucher')]]')) return false;">
          					<input type="hidden" name="action" value="[[$DAgentAction::DELETE_VOUCHER]]">
          					<input type="hidden" name="voucher" value="[[voucher.getId()]]">
										<input type="hidden" name="csrf" value="[[csrf]]">
          					<input type="submit" class='btn btn-danger' value="[[lang.get('button_delete')]]">
          				</form>
          			</td>
          		</tr>
			{{ENDFOREACH}}
		</table>
	</div>
{{ENDIF}}
<form action="agents.php?new=true" method="POST">
	<input type="hidden" name="action" value="[[$DAgentAction::CREATE_VOUCHER]]">
	<input type="hidden" name="csrf" value="[[csrf]]">
	<div class="panel panel-default">
		<table class="table table-bordered table-nonfluid">
			<tr>
				<td>[[lang.get('table_property_new_voucher')]]</td>
				<td>
					<input type="text" class='form-control' name="newvoucher" value="[[Util::randomString(8)]]">
				</td>
				<td>
					<input type="submit" class='btn btn-default' value="[[lang.get('button_create')]]">
				</td>
			</tr>
		</table>
	</div>
</form>
{%TEMPLATE->struct/foot%}